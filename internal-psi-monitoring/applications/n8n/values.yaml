# 1. DATABASE CONFIGURATION
# In this specific chart version, DB settings must be inside 'main'
db:
  type: postgresdb

# 2. MAIN APPLICATION SETTINGS
main:
  # External Postgres settings go here for this chart
  externalPostgresql:
    host: pg-1e155c21-oyegokeodev-f11d.f.aivencloud.com
    port: 20109
    database: n8n
    username: n8n_user
    # The secret name containing the 'password' key
    existingSecret: n8n-db-secret
  
  # Environment variables go under 'config' or 'env' inside 'main'
  env:
    - name: N8N_HOST
      value: "n8n.example.com"
    - name: N8N_PROTOCOL
      value: "https"
    - name: GENERIC_TIMEZONE
      value: "UTC"
    - name: N8N_SECURE_COOKIE
      value: "true"
    - name: N8N_ENABLE_COMMUNITY_NODES
      value: "true"

# 3. INGRESS (AWS ALB Shared)
# ingress:
#   enabled: true
#   className: alb
#   annotations:
#     alb.ingress.kubernetes.io/scheme: internet-facing
#     alb.ingress.kubernetes.io/target-type: ip
#     alb.ingress.kubernetes.io/group.name: "psi-monitoring"
#     alb.ingress.kubernetes.io/group.order: "20"
#     alb.ingress.kubernetes.io/listen-ports: '[{"HTTP": 80}, {"HTTPS": 443}]'
#     alb.ingress.kubernetes.io/ssl-redirect: '443'
#     alb.ingress.kubernetes.io/healthcheck-path: /healthz
#     alb.ingress.kubernetes.io/healthcheck-interval-seconds: '10'
#     alb.ingress.kubernetes.io/success-codes: "200"
#   hosts:
#     - host: n8n.example.com
#       paths:
#         - path: /
#           pathType: Prefix